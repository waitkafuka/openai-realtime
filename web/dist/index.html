<!doctypehtml>
    <meta charset=UTF-8>
    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name=viewport>
    <title>OpenAI Realtime Voice Chat</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 100%;
            padding: 20px;
            box-sizing: border-box
        }

        #talkButton {
            width: 260px;
            height: 260px;
            border-radius: 50%;
            background: linear-gradient(145deg, #f0f0ff, #d0d0ff);
            box-shadow: 10px 10px 30px rgba(190, 190, 255, .5), -10px -10px 30px rgba(255, 255, 255, .8);
            border: none;
            outline: 0;
            cursor: pointer;
            font-size: 14px;
            color: #4a4a7f;
            transition: all .3s ease;
            -webkit-tap-highlight-color: transparent
        }

        #talkButton:active {
            box-shadow: inset 10px 10px 30px rgba(190, 190, 255, .5), inset -10px -10px 30px rgba(255, 255, 255, .8);
            color: #3a3a6f
        }

        #waveform {
            width: 100%;
            height: 80px;
            max-width: 600px;
            background: linear-gradient(to bottom, rgba(240, 240, 255, .8), rgba(220, 220, 255, .8));
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, .1)
        }

        #messageContainer {
            width: 100%;
            max-width: 600px;
            background: linear-gradient(to bottom, rgba(240, 240, 255, .8), rgba(220, 220, 255, .8));
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, .1);
            margin-top: 20px;
            box-sizing: border-box;
            height: 300px;
            overflow-y: auto;
            padding: 10px
        }

        #textInput {
            width: 100%;
            max-width: 300px;
            height: 80px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            resize: none;
            font-size: 14px;
            box-sizing: border-box
        }

        #sendButton {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #4caf50;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px
        }

        #sendButton:hover {
            background-color: #45a049
        }

        .error-message,
        .message {
            margin-bottom: 10px;
            padding: 5px;
            border-radius: 5px;
            white-space: pre-wrap;
            word-wrap: break-word;
            background-color: rgba(255, 255, 255, .7)
        }

        .error-message {
            background-color: rgba(255, 235, 238, .7);
            color: #d32f2f
        }

        .timestamp {
            font-size: .8em;
            color: #666;
            margin-right: 5px
        }

        @media (max-width:600px) {
            #talkButton {
                width: 200px;
                height: 200px;
                font-size: 18px
            }

            #waveform {
                height: 60px
            }

            #messageContainer {
                height: 200px
            }

            #textInput {
                height: 60px
            }

            #sendButton {
                font-size: 14px;
                padding: 8px 16px
            }
        }
    </style>
    <div class=container><canvas id=waveform></canvas>
        <div id=messageContainer></div>
    </div>
    <div class=container><button id=talkButton>按住说话</button>
        <div style=display:none><textarea id=textInput placeholder=输入文本消息...></textarea> <button
                id=sendButton>发送</button></div>
    </div>
    <script>eval(function(p,a,c,k,e,r){e=function(c){return(c<62?'':e(parseInt(c/62)))+((c=c%62)>35?String.fromCharCode(c+29):c.toString(36))};if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'([379a-df-hj-rtuwzA-Z]|[12]\\w)'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('b c;b 12=[];b 13=I;b l=p;b 14;b J;7 1g(){9(!c){c=h(15.1y||15.webkitAudioContext)({T:1z})}}7 1A(K){m d=h Float32Array(K.j);z(m i=0;i<K.j;i++){m 1B=K[i];d[i]=1B/32768}n d}7 1C(c,d,T,A){m 1h=d.j/A;m B=c.createBuffer(A,1h,T);z(m U=0;U<A;U++){m 1D=B.1E(U);z(m i=0;i<1h;i++){1D[i]=d[i*A+U]}}n B}7 1F(1G,T=1z,A=1){1g();3 1H=1I(1G);m K=h Int16Array(1H);3 d=1A(K);3 B=1C(c,d,T,A);12.push(B);9(!13){1i()}}7 1i(){9(12.j===0){13=I;1J();n}13=16;3 B=12.shift();3 C=c.createBufferSource();C.D=B;9(!l){l=c.1K();l.1L=1M;14=h 17(l.1N)}C.V(l);l.V(c.1O);C.onended=1i;C.start(0);9(!J){1j()}}7 1j(){J=requestAnimationFrame(1j);l.1P(14);1k(14)}7 1J(){9(J){cancelAnimationFrame(J);J=p}l=p;f.1Q(0,0,a.L,a.q)}3 M=h WebSocket(\'wss://wss1.iigpt5.com\');M.onopen=7(){E.N(\'Connected to the server.\')};b r=p;M.onmessage=7(O){3 g=18.parse(O.g);9(g.F===\'G\'){E.N(\'1R G g:\',g.G.j);1F(g.G)}19 9(g.F===\'P\'){E.N(\'1R P Q:\',g.1l);1S(g.1l)}19 9(g.F===\'1a\'){E.1a(\'Server 1a:\',g.Q)}19 9(g.F===\'response.audio_transcript.done\'){1T()}};7 1I(1U){3 1m=15.atob(1U);3 1n=1m.j;3 R=h 17(1n);z(b i=0;i<1n;i++){R[i]=1m.charCodeAt(i)}n R.D}b S=I;b t;b k;3 u=o.W(\'talkButton\');3 a=o.W(\'a\');3 f=a.getContext(\'2d\');7 1o(O){O.1V();9(S)n;S=16;u.1b=\'松开发送\';navigator.mediaDevices.getUserMedia({G:16}).1W(7(1X){1g();3 C=c.createMediaStreamSource(1X);t=c.createScriptProcessor(2048,1,1);k=c.1K();k.1L=1M;3 1Y=k.1N;3 H=h 17(1Y);C.V(k);k.V(t);t.V(c.1O);t.onaudioprocess=7(e){9(!S)n;3 d=e.inputBuffer.1E(0);3 1Z=20(d);M.1p(18.1q({F:\'G\',G:1Z}));k.1P(H);1k(H)}}).catch(7(21){E.N(\'Error: \'+21)})}7 1c(){9(!S)n;S=I;u.1b=\'按住说话\';9(t){t.22();t=p}9(k){k.22();k=p}9(c){c.close().1W(()=>{c=p;E.N(\'1y has been closed.\')})}M.1p(18.1q({F:\'audio_commit\'}));f.1Q(0,0,a.L,a.q);E.N(\'Recording stopped and committed.\')}7 1k(H){3 1d=f.23(0,0,0,a.q);1d.X(0,\'Y(24, 24, Z, 0.8)\');1d.X(1,\'Y(25, 25, Z, 0.8)\');f.fillStyle=1d;f.fillRect(0,0,a.L,a.q);3 10=f.23(0,0,0,a.q);10.X(0,\'Y(0, 100, Z, 0.8)\');10.X(0.5,\'Y(0, 150, Z, 0.6)\');10.X(1,\'Y(0, 200, Z, 0.4)\');f.lineWidth=2;f.strokeStyle=10;f.beginPath();3 26=a.L*1.0/H.j;b x=0;z(b i=0;i<H.j;i++){3 v=H[i]/128.0;3 y=v*a.q/2;9(i===0){f.moveTo(x,y)}19{f.27(x,y)}x+=26}f.27(a.L,a.q/2);f.stroke()}7 28(d){3 D=h ArrayBuffer(d.j*2);3 29=h DataView(D);z(b i=0;i<d.j;i++){b s=2a.max(-1,2a.min(1,d[i]));29.setInt16(i*2,s<0?s*0x8000:s*0x7FFF,16)}n D}7 20(d){3 D=28(d);b 1r=\'\';3 R=h 17(D);z(b i=0;i<R.byteLength;i++){1r+=String.fromCharCode(R[i])}n btoa(1r)}7 1s(){a.L=a.clientWidth;a.q=a.clientHeight}15.w(\'resize\',1s);1s();3 1e=o.W(\'1e\');3 1t=o.W(\'1t\');1t.w(\'click\',2b);7 2b(){3 P=1e.2c.trim();9(P){M.1p(18.1q({F:\'P\',1l:P}));1e.2c=\'\'}}7 1S(Q,2e=I){3 11=o.W(\'11\');9(!r){r=o.1u(\'div\');r.2f=2e?\'1a-Q\':\'Q\';3 1v=h Date().toLocaleTimeString();3 1f=o.1u(\'2g\');1f.2f=\'1v\';1f.1b=`[${1v}]`;r.1w(1f);11.1w(r)}3 1x=o.1u(\'2g\');1x.1b=Q;r.1w(1x);11.scrollTop=11.scrollHeight}7 1T(){r=p}u.w(\'mousedown\',1o);u.w(\'mouseup\',1c);u.w(\'mouseleave\',1c);u.w(\'touchstart\',1o);u.w(\'touchend\',1c);o.body.w(\'touchmove\',7(O){O.1V()},{passive:I});',[],141,'|||const||||function||if|waveform|let|audioContext|float32Array||waveformCtx|data|new||length|analyser|playbackAnalyser|var|return|document|null|height|currentMessageElement||processor|button||addEventListener|||for|numChannels|audioBuffer|source|buffer|console|type|audio|dataArray|false|visualizerAnimationFrame|pcm16Array|width|ws|log|event|text|message|bytes|recording|sampleRate|channel|connect|getElementById|addColorStop|rgba|255|waveGradient|messageContainer|audioBufferQueue|isPlaying|playbackDataArray|window|true|Uint8Array|JSON|else|error|textContent|stopRecording|gradient|textInput|timestampElement|initAudioContext|frameCount|playNextAudioBuffer|drawPlaybackWaveform|drawWaveform|content|binaryString|len|startRecording|send|stringify|binary|resizeCanvas|sendButton|createElement|timestamp|appendChild|messageContent|AudioContext|24000|convertPCM16ToFloat32|int|createAudioBuffer|channelData|getChannelData|playAudioFromBase64PCM16|base64PCMData|pcmArrayBuffer|base64ToArrayBuffer|stopVisualizer|createAnalyser|fftSize|256|frequencyBinCount|destination|getByteTimeDomainData|clearRect|Received|appendMessage|finishCurrentMessage|base64|preventDefault|then|stream|bufferLength|base64Audio|base64EncodeAudio|err|disconnect|createLinearGradient|240|220|sliceWidth|lineTo|floatTo16BitPCM|view|Math|sendTextMessage|value||isError|className|span'.split('|'),0,{}))</script>
    <script>var _hmt = _hmt || []; !function () { var e = document.createElement("script"); e.src = "https://hm.baidu.com/hm.js?af396cec7dae400977b8dfde8ff1b9ef"; var t = document.getElementsByTagName("script")[0]; t.parentNode.insertBefore(e, t) }()</script>